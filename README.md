# ncad_UI_creator

Вспомогательная библиотека для создания UI-описания команд (cfg + cuix) для nanoCAD .NET API

# Использование

1. Создается отдельное приложение (UI_LIB), к ней линкуется NC_UI_Creator_Lib.dll;
2. В UI_LIB используя классы из NC_UI_Creator_Lib.dll создается описание меню, в качестве имен команд используя данные из CommandMethod загружаемой библиотеки классов;
3. UI_LIB компилируется и запускается, создавая файлы интерфейса (CFG + CUIX) в заданном каталоге. Далее можно настроить их авто-копирование в bin-папку плагина;
4. Предполагается, что при плагине имеется \*.package файл, где будет вписан целевой CFG

## Ручное описание интерфейса

[Пример использования см. в файле](src/NC_UI_Creator_Sample/UI_Creator_Sample.cs)

## Полуавтоматическая генерация интерфейса

Автоматизированная генерация UI может быть настроена для случая описания интерфейса в CSV-файле, см. функциональность класса `UI_Creator_FromCSV`. 

Предполагается, что исходный файл содержит следующие данные:

| Command Name                         | Display Name             | Description                                                        | Panel                                            | ButtonStyle                                                                         | SplitButtonName                                                                              |
| ------------------------------------ | ------------------------ | ------------------------------------------------------------------ | ------------------------------------------------ | ----------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------- |
| Наименование команды (CommandMethod) | Отображаемое имя команды | Описание команды (всплывающий текст при наведении на элемент меню) | Наименование панели, где будет размещена команда | Размер кнопки и наличие текста, значения <br/>NC_UI_Creator_Lib. ButtonStyleVariant | Название кнопки с выпадающими командами. Если это одиночная команда, то просто пустая строка |
| NCAD_TEST_1                          | Тестовая команда 1       | Выводит в командную строку фразу "Hello, ncad!"                    | Общее                                            | LargeWithText                                                                       |                                                                                              |

Конструктору класса UI_Creator_FromCSV надо передать абсолютный файловый путь до файла, символ разделителя строки и флаг, пропускать ли первую (заголовочную) строку файла.

Помимо этого, можно указать следующие свойства перед началом генерации:

- `Modes`: Список режимов генерации данных (по умолчанию создается ленточное меню), можно добавить формирование классического меню и панелей инструментов:

```csharp
CreationMode.WithClassicMenu //classic menu
CreationMode.WithToolbars //toolbars
```

- `IconResVariant`: формат хранения иконок -- локальные файлы или ресурсная DLL;

- `IconsRefPath_or_DLL`: наименование папки с иконками либо название ресурсной DLL с расширением (какой задан `IconResVariant`);

- `IconFormatVariant`: расширение файлов иконок (разрешенные BMP или ICO);

- `RibbonName`: наименование ленты. По умолчанию = имени файла CSV без расширения;

# Возможности

* создание ленточного меню (ленты, панели, кнопки, кнопки с выпадающими значениями, ряды кнопок);
* связывание элементов меню с командами (cfg);
* создание классического меню (cfg);
* создание панелей инструментов и управление их закреплением (cfg);